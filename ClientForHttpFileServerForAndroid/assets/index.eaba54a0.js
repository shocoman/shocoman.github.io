var We=Object.defineProperty,Ye=Object.defineProperties;var Je=Object.getOwnPropertyDescriptors;var ke=Object.getOwnPropertySymbols;var Ke=Object.prototype.hasOwnProperty,Qe=Object.prototype.propertyIsEnumerable;var we=(e,l,i)=>l in e?We(e,l,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[l]=i,ze=(e,l)=>{for(var i in l||(l={}))Ke.call(l,i)&&we(e,i,l[i]);if(ke)for(var i of ke(l))Qe.call(l,i)&&we(e,i,l[i]);return e},Me=(e,l)=>Ye(e,Je(l));import{d as j,r as F,o as Y,a as Ze,b as h,c as _,e as r,w as me,n as O,p as ge,f as he,g as ne,t as $,F as W,h as oe,i as et,j as tt,k as Le,l as Fe,m as st,q as R,s as Se,u as z,v as P,x as $e,y as ve,z as xe,A as Ce,B as nt}from"./vendor.aa8b1519.js";const ot=function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const d of a)if(d.type==="childList")for(const c of d.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function i(a){const d={};return a.integrity&&(d.integrity=a.integrity),a.referrerpolicy&&(d.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?d.credentials="include":a.crossorigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function n(a){if(a.ep)return;a.ep=!0;const d=i(a);fetch(a.href,d)}};ot();const be="/storage/emulated/0/",De="http://localhost:8089/api/";let A=De,E=!0;const Be=e=>A=e,Ae=e=>E=e;function Ee(e){return`${A}getFiles?path=${e}`}function Re(e){return`${A}upload?path=${e}`}function Oe(e){return`${A}availableSpace?path=${e}`}function Ne(e){return`${A}download?path=${e}`}function Ue(e,l){return`${A}move?path=${e}&newName=${l}`}function He(e){return`${A}delete?path=${e}`}var Te=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",defaultStoragePath:be,defaultApiLink:De,get apiLink(){return A},get useTestFileSystem(){return E},setApiLink:Be,setUseTestFileSystem:Ae,generateFilesLink:Ee,generateUploadLink:Re,generateAvailableSpaceLink:Oe,generateDownloadFileLink:Ne,generateMoveOrRenameFileLink:Ue,generateDeleteFileLink:He});function it(e){if(Math.abs(e)<1024)return e+" B";const n=["kB","MB","GB","TB"],a=10**2;let d=-1;do e/=1024,++d;while(Math.round(Math.abs(e)*a)/a>=1024&&d<n.length-1);return e.toFixed(2)+" "+n[d]}function lt(e){return new Date(e).toISOString().replace("T"," ").split(".")[0]}function ie(e,l){const i="/",n=e.endsWith(i)?e.substring(0,e.length-1):e,a=l.startsWith(i)?l.substring(1):l;return n+i+a}function Ie(e){return e.split("/").slice(0,-2).join("/")+"/"}var V=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",getHumanReadableFileSize:it,formatDate:lt,combinePath:ie,getParentFolderPath:Ie});var K=(e,l)=>{const i=e.__vccOpts||e;for(const[n,a]of l)i[n]=a;return i};const Ve=e=>(ge("data-v-537a6f0e"),e=e(),he(),e),at=["onDragenter","onDragover","onDragleave","onDrop"],rt=Ve(()=>r("i",{class:"bi bi-download",style:{"font-size":"3rem"}},null,-1)),dt=Ve(()=>r("span",{style:{"margin-left":"0.5rem"}},"Drag and drop your files here!",-1)),ut=[rt,dt],ft=j({emits:["fileWasDropped"],setup(e,{emit:l}){const i=F(0),n=F(0);Y(()=>{document.addEventListener("dragenter",d),document.addEventListener("dragleave",c)}),Ze(()=>{document.removeEventListener("dragenter",d),document.removeEventListener("dragleave",c)});function a(p){const w=p.dataTransfer;return w?!!Array.from(w==null?void 0:w.items).find(v=>v.kind=="file"):!1}function d(p){a(p)&&(i.value+=1)}function c(p){a(p)&&(i.value-=1)}function I(p){n.value+=1}function g(p){const w=p.dataTransfer;w!=null&&(w.dropEffect="copy")}function b(p){n.value-=1}function k(p){if(n.value=0,i.value=0,p.dataTransfer&&p.dataTransfer.files.length>0){const w=Array.from(p.dataTransfer.files);l("fileWasDropped",w)}}return(p,w)=>(h(),_("div",null,[r("div",{onDragenter:me(I,["prevent"]),onDragover:me(g,["prevent"]),onDragleave:me(b,["prevent"]),onDrop:me(k,["prevent"]),class:O({"drop-helper":!0,"drop-helper__hidden":i.value==0,"drop-helper__dropping":n.value>0})},ut,42,at)]))}});var ct=K(ft,[["__scopeId","data-v-537a6f0e"]]);const pt=e=>(ge("data-v-cfba8abc"),e=e(),he(),e),mt={key:1,class:"overlay-container",title:"Cancel upload?"},vt={class:"overlay overlay-container circular-progress-bar"},gt=pt(()=>r("div",{class:"overlay progress-background"},null,-1)),ht={key:0,class:"overlay cancel-button bi bi-x-circle-fill"},_t={key:1,class:"overlay progress-value"},It=j({props:{progressValue:null,isFinished:{type:Boolean},iconClassName:null},emits:["downloadIsCancelled"],setup(e,{emit:l}){const i=e,n=F(null),a=F(null);Y(()=>{i.progressValue!==void 0&&d(i.progressValue)}),ne(i,()=>{i.progressValue!==void 0&&d(i.progressValue)});function d(I){const g=n.value,b=a.value;if(g==null||b==null)return;const k=I/100*360;g.style.transform=`rotate(${k}deg)`,b.style.transform=k<=180?"rotate(0deg)":"rotate(180deg)",b.style.borderColor=k<=180?"var(--progress-background-color)":"var(--progress-color)"}const c=F(!1);return(I,g)=>(h(),_("div",{class:"root",onClick:g[0]||(g[0]=()=>l("downloadIsCancelled")),onMouseenter:g[1]||(g[1]=()=>c.value=!0),onMouseleave:g[2]||(g[2]=()=>c.value=!1)},[i.isFinished===!0?(h(),_("div",{key:0,class:O(["icon bi",[i.iconClassName]])},null,2)):(h(),_("div",mt,[r("div",{class:O(["overlay icon-with-progress-bar bi",[i.iconClassName]])},null,2),r("div",vt,[r("div",{class:"overlay half-progress",ref_key:"halfProgressBar",ref:n},null,512),r("div",{class:"overlay shadow-progress",ref_key:"shadowProgressBar",ref:a},null,512),gt]),c.value?(h(),_("div",ht)):(h(),_("div",_t,$(i.progressValue|0)+"%",1))]))],32))}});var _e=K(It,[["__scopeId","data-v-cfba8abc"]]);const bt={class:"root"},Dt={class:"button-list"},yt=["onClick"],kt=j({props:{show:{type:Boolean},pos:null,menuItem:null},setup(e){const l=e;return(i,n)=>(h(),_("div",bt,[r("div",{class:O(["context-menu",{"context-menu--hidden":!l.show}]),style:et({transform:`translate(${l.pos.x}px, ${l.pos.y}px)`})},[r("ul",Dt,[(h(!0),_(W,null,oe(l.menuItem,a=>(h(),_("li",{role:"button",onClick:d=>a.action()},$(a.menuName),9,yt))),256))])],6)]))}});var wt=K(kt,[["__scopeId","data-v-4e4c3991"]]);const zt={class:"root"},Mt={class:"topbar__title"},Ft={class:"main-content"},St={class:"button-group"},$t=j({props:{show:{type:Boolean},popupTitle:null},emits:["okPressed","cancelPressed"],setup(e,{emit:l}){const i=e;let n=null,a=null,d=null,c=null,I=!1,g=0;Y(()=>{document.addEventListener("mousemove",b),document.addEventListener("mouseup",k)}),tt(()=>{document.removeEventListener("mousemove",b),document.removeEventListener("mouseup",k)});function b(v){if(I||g===1){const m=a;m.style.left=`${v.clientX-n.offsetLeft-d}px`,m.style.top=`${v.clientY-n.offsetTop-c}px`}else if(g===2){const m=a,y=m.getBoundingClientRect();v.clientX-y.left>y.width/2?m.style.width=`${v.clientX-y.left}px`:m.style.width=`${y.right-v.clientX}px`}}function k(v){I=!1,g=0}function p(v){n=v.target,a=v.target.closest(".popup-window"),a&&(d=v.offsetX,c=v.offsetY,g=1,I=!0)}function w(v){const m=v.target.closest(".popup-window"),y=S(v,m);if(y===0){m.style.cursor="initial";return}switch(v.stopPropagation(),y){case 4:m.style.cursor="nwse-resize";break;case 5:m.style.cursor="nesw-resize";break;case 2:m.style.cursor="ew-resize";break;case 3:m.style.cursor="ns-resize";break}}function S(v,m){const y=m.getBoundingClientRect(),Z=v.clientX-y.left,N=v.clientY-y.top,C=5,X=Z<C,L=Z>y.width-C,re=N<C,B=N>y.height-C;return X&&re||L&&B?4:L&&re||X&&B?5:X||L?2:0}function Q(v){const m=v.target.closest(".popup-window");m.getBoundingClientRect();const y=S(v,m);if(y===0){m.style.cursor="initial";return}switch(v.stopPropagation(),console.log(y),g=y,a=m,d=v.offsetX,c=v.offsetY,y){case 4:{m.style.cursor="nwse-resize";break}case 5:{m.style.cursor="nesw-resize";break}case 2:{m.style.cursor="ew-resize";break}case 3:{m.style.cursor="ns-resize";break}}}return(v,m)=>(h(),_("div",zt,[r("div",{class:O(["popup-window",{"popup-window--hidden":!i.show}]),onMousemoveCapture:w,onMousedownCapture:Q},[r("div",{class:"topbar",onMousedown:p},[r("span",Mt,$(i.popupTitle),1),r("i",{class:"bi bi-x topbar__close_btn",role:"button",onClick:m[0]||(m[0]=y=>l("cancelPressed"))})],32),r("div",Ft,[Le(v.$slots,"default",{},void 0,!0)]),r("div",St,[r("button",{class:"ok_btn",onClick:m[1]||(m[1]=y=>l("okPressed"))},"Ok"),r("button",{class:"cancel_btn",onClick:m[2]||(m[2]=y=>l("cancelPressed"))},"Cancel")])],34)]))}});var xt=K($t,[["__scopeId","data-v-f6ff3b78"]]),ae=[{fileInfo:{name:"Android",size:0,isDir:!0,lastModified:164571185e4},filesInside:[{fileInfo:{name:"data",size:0,isDir:!0,lastModified:1645200272e3},filesInside:[{fileInfo:{name:".nomedia",size:0,isDir:!1,lastModified:164481838e4},filesInside:[]},{fileInfo:{name:"com.google.android.gms",size:0,isDir:!0,lastModified:164481838e4},filesInside:[{fileInfo:{name:"files",size:0,isDir:!0,lastModified:164481838e4},filesInside:[]}]},{fileInfo:{name:"com.google.android.apps.maps",size:0,isDir:!0,lastModified:1644818425e3},filesInside:[{fileInfo:{name:"files",size:0,isDir:!0,lastModified:1644818425e3},filesInside:[]},{fileInfo:{name:"testdata",size:0,isDir:!0,lastModified:1644818425e3},filesInside:[]},{fileInfo:{name:"cache",size:0,isDir:!0,lastModified:1644818425e3},filesInside:[]}]},{fileInfo:{name:"com.google.android.youtube",size:0,isDir:!0,lastModified:1644818438e3},filesInside:[{fileInfo:{name:"files",size:0,isDir:!0,lastModified:1644818438e3},filesInside:[]},{fileInfo:{name:"cache",size:0,isDir:!0,lastModified:1646067075e3},filesInside:[{fileInfo:{name:"exo",size:0,isDir:!0,lastModified:1644818438e3},filesInside:[{fileInfo:{name:"69fb45cea3a0ca0d.uid",size:0,isDir:!1,lastModified:1644818438e3},filesInside:[]}]}]}]},{fileInfo:{name:"com.google.android.googlequicksearchbox",size:0,isDir:!0,lastModified:1644818501e3},filesInside:[{fileInfo:{name:"files",size:0,isDir:!0,lastModified:1645200219e3},filesInside:[{fileInfo:{name:"download_cache",size:0,isDir:!0,lastModified:1645200219e3},filesInside:[]}]}]},{fileInfo:{name:"com.google.android.inputmethod.latin",size:0,isDir:!0,lastModified:1644905594e3},filesInside:[{fileInfo:{name:"cache",size:0,isDir:!0,lastModified:1644905594e3},filesInside:[]}]},{fileInfo:{name:"com.google.android.apps.docs",size:0,isDir:!0,lastModified:1644935356e3},filesInside:[{fileInfo:{name:"cache",size:0,isDir:!0,lastModified:1644935352e3},filesInside:[]},{fileInfo:{name:"files",size:0,isDir:!0,lastModified:1644935356e3},filesInside:[{fileInfo:{name:"pinned_docs_files_do_not_edit",size:0,isDir:!0,lastModified:1644935356e3},filesInside:[]}]}]},{fileInfo:{name:"com.android.chrome",size:0,isDir:!0,lastModified:1645200272e3},filesInside:[{fileInfo:{name:"files",size:0,isDir:!0,lastModified:1645200272e3},filesInside:[{fileInfo:{name:"Download",size:0,isDir:!0,lastModified:1645200272e3},filesInside:[]}]}]}]}]},{fileInfo:{name:"Music",size:0,isDir:!0,lastModified:1645771897e3},filesInside:[]},{fileInfo:{name:"Podcasts",size:0,isDir:!0,lastModified:1646143023e3},filesInside:[]},{fileInfo:{name:"Ringtones",size:0,isDir:!0,lastModified:1646124446e3},filesInside:[]},{fileInfo:{name:"geoquiz",size:652,isDir:!0,lastModified:1645711338e3},filesInside:[{fileInfo:{name:"ExampleInstrumentedTest.kt",size:652,isDir:!1,lastModified:1645711338e3},filesInside:[]}]},{fileInfo:{name:"Notifications",size:0,isDir:!0,lastModified:1644818413e3},filesInside:[]},{fileInfo:{name:"Movies",size:0,isDir:!0,lastModified:1644818413e3},filesInside:[]},{fileInfo:{name:"Download",size:92160,isDir:!0,lastModified:1645200275e3},filesInside:[{fileInfo:{name:"zork1.z3",size:92160,isDir:!1,lastModified:1645200272e3},filesInside:[]}]},{fileInfo:{name:"DCIM",size:0,isDir:!0,lastModified:1644818413e3},filesInside:[]},{fileInfo:{name:"ServerData",size:392836,isDir:!0,lastModified:1646130432e3},filesInside:[{fileInfo:{name:"favicon.ico",size:4286,isDir:!1,lastModified:1646130391e3},filesInside:[]},{fileInfo:{name:"index.html",size:494,isDir:!1,lastModified:1646130391e3},filesInside:[]},{fileInfo:{name:"assets",size:388056,isDir:!0,lastModified:1646130433e3},filesInside:[{fileInfo:{name:"bootstrap-icons.92f8082b.woff",size:137124,isDir:!1,lastModified:1646130432e3},filesInside:[]},{fileInfo:{name:"bootstrap-icons.c874e14c.woff2",size:102536,isDir:!1,lastModified:1646130432e3},filesInside:[]},{fileInfo:{name:"index.17674037.css",size:75100,isDir:!1,lastModified:1646130433e3},filesInside:[]},{fileInfo:{name:"index.8ca9fed3.js",size:17785,isDir:!1,lastModified:1646130433e3},filesInside:[]},{fileInfo:{name:"vendor.ec4ea153.js",size:55511,isDir:!1,lastModified:1646130433e3},filesInside:[]}]}]},{fileInfo:{name:"zip test 2.zip",size:645162215,isDir:!1,lastModified:164482372e4},filesInside:[]},{fileInfo:{name:"TextFiction",size:92524,isDir:!0,lastModified:1646128363e3},filesInside:[{fileInfo:{name:"games",size:92160,isDir:!0,lastModified:1645200286e3},filesInside:[{fileInfo:{name:"zork1.z3",size:92160,isDir:!1,lastModified:1645200286e3},filesInside:[]}]},{fileInfo:{name:"savegames",size:364,isDir:!0,lastModified:1645200286e3},filesInside:[{fileInfo:{name:"zork1.z3",size:364,isDir:!0,lastModified:1645200319e3},filesInside:[{fileInfo:{name:"AUTOSAVE",size:364,isDir:!1,lastModified:1645676788e3},filesInside:[]}]}]},{fileInfo:{name:"gamedata",size:0,isDir:!0,lastModified:1645200287e3},filesInside:[{fileInfo:{name:"zork1.z3",size:0,isDir:!0,lastModified:1645200287e3},filesInside:[]}]}]},{fileInfo:{name:"Some book about web stuff, ASP.NET MVC 5, Bootstrap and Knockout.js.pdf",size:4496356,isDir:!1,lastModified:1646124883e3},filesInside:[]},{fileInfo:{name:"1298u12jkl12nk21nekj12kdn1jndk1n2jdnkj2kdnkn 3 asdaskdnasn nasdnk3k er 3243232hi2f3n   saasdsa.txt",size:0,isDir:!1,lastModified:1646142148e3},filesInside:[]},{fileInfo:{name:"Just a big file.archive",size:2469606195,isDir:!1,lastModified:1646142446e3},filesInside:[]}];const J=e=>e.replace(be,"");function le(e,l){let i={fileInfo:{isDir:!0,name:"root",size:0,lastModified:0},filesInside:e},n=l.split("/").filter(a=>a.length>0);for(const a of n)i=i.filesInside.find(c=>c.fileInfo.name===a);return i}function Ct(e,l){const i=J(l),n=le(e,i);return Array.from(n.filesInside.map(a=>a.fileInfo))}function je(e,l){const n=J(l).split("/"),a=n.pop(),d=n.length>0?n.join("/"):"",c=le(e,d),I=c.filesInside.findIndex(g=>g.fileInfo.name===a);console.log(`Remove file '${a}' from folder '${d}'`),c.filesInside.splice(I,1)}function Tt(e,l,i){const n=J(l),a=J(i),d=le(e,n);je(e,n);const c=a.split("/"),I=c.pop();d.fileInfo.name=I;const g=c.length>0?c.join("/"):"";le(e,g).filesInside.push(d)}function Pt(e){const i=n=>n.fileInfo.isDir?n.filesInside.map(a=>i(a)).reduce((a,d)=>a+d,0):n.fileInfo.size;return 4294967296-i({fileInfo:{isDir:!0,name:"root",size:0,lastModified:0},filesInside:e})}function Lt(e,l,i){const n=J(l),a=le(e,n);for(const d of i)console.log(`Add file '${d.fileInfo.name}' to folder '${n}'`),a.filesInside.push(d)}function Bt(e,l,i,{onload:n,onprogress:a,onabort:d}){const c=J(l),I=i.reduce((w,S)=>w+S.size,0),g=4*1024**2,b=1/10;let k=0;const p=setInterval(()=>{k+=g*b;const w=new ProgressEvent("fake progress",{total:I,loaded:k});a(w),k>=I&&(Lt(e,c,i.map(S=>({fileInfo:{isDir:S.webkitRelativePath.length>0,name:S.name,size:S.size,lastModified:S.lastModified},filesInside:[]}))),n(w),clearInterval(p))},b);return{abort:()=>{clearInterval(p),d(new ProgressEvent("fake abort"))}}}function At(e,l){var i=new Blob([],{type:"text/html"});const n=document.createElement("a");n.href=URL.createObjectURL(i),n.download=l,document.body.appendChild(n),n.click(),document.body.removeChild(n)}async function Et(e){if(E)return Pt(ae);const l=Oe(e);try{const n=await(await fetch(l,{method:"GET"})).text();return parseInt(n)}catch(i){return console.error(i.message),0}}async function Rt(e){if(E)return Ct(ae,e);const l=Ee(e);try{return await(await fetch(l,{method:"GET"})).json()}catch(i){return console.error(i.message),[]}}function Ot(e,l,i){if(E)return Bt(ae,l,e,i);const{onload:n,onprogress:a,onabort:d}=i,c=p=>p.webkitRelativePath.length>0?p.webkitRelativePath:p.name,I=new FormData;let g={};for(const p of e)g[c(p)]=p.size;I.append("fileSizes",JSON.stringify(g));for(const p of e)I.append(c(p),p);const b=Re(l),k=new XMLHttpRequest;return a&&(k.upload.onprogress=a),n&&(k.upload.onload=n),d&&(k.upload.onabort=d),k.open("POST",b),k.send(I),k}async function Pe(e,l){if(E)return Tt(ae,e,l);const i=Ue(e,l);try{await(await fetch(i,{method:"PATCH"})).text()}catch(n){console.error(n.message)}}async function Nt(e){if(E)return je(ae,e);const l=He(e);try{await(await fetch(l,{method:"DELETE"})).text()}catch(i){console.error(i.message)}}function Ut(e,l){if(E){At(e,l);return}const i=ie(e,l),n=Ne(i),a=document.createElement("a");a.href=n,a.toggleAttribute("download"),document.body.appendChild(a),a.click(),document.body.removeChild(a)}const Ht=e=>(ge("data-v-4e0fe505"),e=e(),he(),e),Vt={class:"root"},jt=Ht(()=>r("div",{class:"fake-gear"},[r("i",{class:"bi bi-gear-fill gear-icon"})],-1)),Xt={class:"sidebar__content"},qt={class:"sidebar__activator"},Gt=j({setup(e){const l=F(!1);return(i,n)=>(h(),_("div",Vt,[jt,r("div",{class:O(["sidebar",{"sidebar--hidden":!l.value}])},[r("div",Xt,[Le(i.$slots,"default",{},void 0,!0)]),r("div",qt,[r("div",{class:"gear-icon-div",onClick:n[0]||(n[0]=a=>l.value=!l.value)},[r("i",{class:O(["bi bi-gear gear-icon",{"gear-icon--activated":l.value}])},null,2)])])],2)]))}});var Wt=K(Gt,[["__scopeId","data-v-4e0fe505"]]);const x=e=>(ge("data-v-615a5f22"),e=e(),he(),e),Yt=P(" Settings: "),Jt=x(()=>r("label",{for:"isTileModeCheckbox"},"\xA0Tile Mode",-1)),Kt=x(()=>r("label",{for:"isFakeFileSystem"},"\xA0Use Fake File System",-1)),Qt=x(()=>r("label",{for:"serverIPInput"},"Server Api Link: ",-1)),Zt=["disabled"],es=P(" Enter new name for the file: "),ts=x(()=>r("br",null,null,-1)),ss=x(()=>r("input",{id:"fileChooser",class:"file-selector",name:"uploadedfile",type:"file",multiple:""},null,-1)),ns=x(()=>r("input",{id:"dirChooser",class:"file-selector",name:"uploadedfile",type:"file",multiple:"",webkitdirectory:""},null,-1)),os=x(()=>r("hr",null,null,-1)),is={class:"info-panel"},ls=x(()=>r("hr",null,null,-1)),as={key:0},rs=x(()=>r("tr",null,[r("th",null,"Name"),r("th",null,"Size"),r("th",null,"Last Modified"),r("th",null,"Actions")],-1)),ds=x(()=>r("i",{class:"bi bi-arrow-left"},null,-1)),us=P(" Get Up "),fs=[ds,us],cs=["onDragstart","onDrop","onDragover","onDragenter"],ps=["onClick"],ms={key:0,style:{"padding-right":"0.2rem"},class:"bi bi-folder"},vs=["onClick"],gs=["onClick"],hs={key:1,class:"tile-file-manager"},_s=P("Go back "),Is=["title","onDragstart","onDragenter","onDragover","onDragleave","onDrop"],bs=["onClick"],Ds=["title"],ys={role:"button",class:"tile-file"},ks=x(()=>r("hr",null,null,-1)),ws={key:2},zs=P(" Uploading Progress: "),Ms=["value"],Fs=j({setup(e){const l=F(0),i=F(be),n=Fe({get(){const o=i.value;return o.endsWith("/")?o:o+"/"},set(o){i.value=o,window.location.hash=o}}),a=F([]),d=st([]);let c=null;const I=F(!0);ne(n,()=>{b()}),Y(()=>{b()});function g(o){const s=o.sort((f,t)=>f.isDir&&!t.isDir?-1:!f.isDir&&t.isDir?1:f.name.localeCompare(t.name));a.value=s}async function b(){const o=await Rt(n.value);g(o),l.value=await Et(n.value)}function k(o){var u,D;const s=document.getElementById("fileChooser"),f=document.getElementById("dirChooser"),t=[...(u=s.files)!=null?u:[],...(D=f.files)!=null?D:[]];t.length>0&&(p(t),s.files=new DataTransfer().files,f.files=new DataTransfer().files)}function p(o,s=n.value){const f=D=>{let M=1,T=o[0].size;for(;M<o.length&&T<D;){const H=o[M];M++,T+=H.size}return T-=o[M-1].size,[M-1,T]};let t=o.map(D=>D.size).reduce((D,M)=>D+M),u=d.length;for(const D of o){const M={filename:D.name,dirname:D.webkitRelativePath.split("/").slice(0,-1).join("/"),uploadedBytes:0,fullSize:D.size};d.push(M)}c=Ot(o,s,{onload:D=>{b(),d.length=0,c=null},onabort:D=>{console.log("Uploading process was cancelled"),d.length=0,c=null,new Promise(M=>setTimeout(M,1e3)).then(()=>{b()})},onprogress:D=>{const M=D.total-t,T=Math.max(D.loaded-M,0),[H,ue]=f(T),fe=T-ue;for(let se=0;se<H;++se){const pe=d[se+u];pe.uploadedBytes=pe.fullSize}const ce=d[H+u];ce.uploadedBytes=fe}})}function w(){c!=null&&(c.abort(),c=null)}function S(o){o===null?n.value=Ie(n.value):o.isDir?n.value=ie(n.value,o.name):Ut(n.value,o.name)}async function Q(o){const s=ie(n.value,o.name);await Nt(s),await b()}function v(o){return o.uploadedBytes/o.fullSize*100}async function m(o,s){const f=s.length?`${n.value}${s}/`:Ie(n.value),t=n.value+o,u=f+o;await Pe(t,u),await b()}async function y(o,s){const f=n.value+o,t=n.value+s;await Pe(f,t),await b()}function Z(o,s){const f=o.dataTransfer;f!=null&&(f.setData("text/plain",s.name),f.dropEffect="move")}function N(o,s){var t,u;console.log("DragEnter",o);const f=o.target;s!=null&&!s.isDir||(u=(t=f.closest(".tile-file"))==null?void 0:t.classList)==null||u.toggle("droppable")}function C(o,s){o.preventDefault();const f=o.dataTransfer;f!=null&&(f.dropEffect="move")}function X(o,s){var t,u;console.log("DragLeave",o);const f=o.target;s!=null&&!s.isDir||(u=(t=f.closest(".tile-file"))==null?void 0:t.classList)==null||u.toggle("droppable")}async function L(o,s){var T,H,ue,fe,ce;o.preventDefault(),console.log("Something is dropped",o,o.target);const f=o.target,t=o.currentTarget;(H=(T=f.closest(".tile-file"))==null?void 0:T.classList)==null||H.remove("droppable"),(fe=(ue=t.closest(".tile-file"))==null?void 0:ue.classList)==null||fe.remove("droppable");const u=o.dataTransfer;if(!u)return;const D=(ce=s==null?void 0:s.name)!=null?ce:"";if(u.files.length>0){const se=[...u.files],pe=(s==null?void 0:s.isDir)?`${n.value}/${D}/`:n.value;p(se,pe);return}if(s!=null&&!s.isDir)return;const M=u.getData("text/plain");M&&M!==D&&m(M,D)}const re=Fe(()=>{const o=new Map;for(const s of d){const f=s.dirname.length>0?ie(s.dirname,s.filename).split("/")[0]:s.filename;o.has(f)?(o.get(f).uploadedBytes+=s.uploadedBytes,o.get(f).fullSize+=s.fullSize):o.set(f,Me(ze({},s),{filename:f}))}return Array.from(o.values())}),B=F(!1),q=F({x:0,y:0});let U=F(null);function Xe(o,s){o.preventDefault(),ee.value=!1,console.log(o,q.value.x,q.value.y);const t=o.target.closest(".main");if(!t)return;B.value=!0;const u=o.clientX-t.offsetLeft,D=o.clientY-t.offsetTop;q.value.x=u,q.value.y=D,U.value=s,console.log("New post",q.value)}const qe=[{menuName:"Open",action:()=>{S(U.value),B.value=!1}},{menuName:"Rename",action:()=>{ye(U.value),B.value=!1}},{menuName:"Delete",action:async()=>{await Q(U.value),B.value=!1}}];function ye(o){ee.value=!0,de.value=o.name,U.value=o}const ee=F(!1),de=F("popupTextPlaceholder");function Ge(){var o;ee.value=!1,y((o=U.value)==null?void 0:o.name,de.value)}const G=F(E),te=F(A);return ne(G,o=>{Ae(o),b(),localStorage.setItem("useFakeFileSystemCheckbox",`${o}`)}),ne(te,o=>{Be(o),b(),localStorage.setItem("serverApiLink",`${o}`)}),ne(I,o=>{localStorage.setItem("isTileMode",`${o}`)}),Y(()=>{I.value=localStorage.getItem("isTileMode")!=="false",G.value=localStorage.getItem("useFakeFileSystemCheckbox")!=="false",te.value=localStorage.getItem("serverApiLink")||De}),Y(()=>{const o=window.location.hash;if(o.length>0){const s=o.slice(1);n.value=s}window.onhashchange=()=>{const s=window.location.hash;if(s.length>0){const f=s.slice(1);n.value=f}}}),(o,s)=>{var f;return h(),_(W,null,[R(Wt,null,{default:Se(()=>[Yt,r("div",null,[ve(r("input",{id:"isTileModeCheckbox",type:"checkbox","onUpdate:modelValue":s[0]||(s[0]=t=>I.value=t)},null,512),[[xe,I.value]]),Jt]),r("div",null,[ve(r("input",{id:"isFakeFileSystem",type:"checkbox","onUpdate:modelValue":s[1]||(s[1]=t=>G.value=t)},null,512),[[xe,G.value]]),Kt]),r("div",{class:O({"disabled-input":G.value})},[Qt,ve(r("input",{id:"serverIPInput",disabled:G.value,"onUpdate:modelValue":s[2]||(s[2]=t=>te.value=t)},null,8,Zt),[[Ce,te.value]]),r("i",{title:"Reset?",onClick:s[3]||(s[3]=t=>te.value=z(Te).defaultApiLink),role:"button",class:"bi bi-arrow-counterclockwise default-reset-indicator"})],2)]),_:1}),R(xt,{show:ee.value,"popup-title":`Rename File '${(f=z(U))==null?void 0:f.name}'`,onOkPressed:Ge,onCancelPressed:s[5]||(s[5]=t=>ee.value=!1)},{default:Se(()=>[es,ts,ve(r("input",{"onUpdate:modelValue":s[4]||(s[4]=t=>de.value=t),size:"50"},null,512),[[Ce,de.value]])]),_:1},8,["show","popup-title"]),R(wt,{show:B.value,pos:q.value,"menu-item":qe},null,8,["show","pos"]),R(ct,{onFileWasDropped:s[6]||(s[6]=t=>p(t))}),r("div",{class:"main",onClick:s[20]||(s[20]=()=>B.value=!1)},[r("div",null,[r("div",{class:"upload-btn-group",role:"group"},[r("input",{onClick:k,class:"upload-btn",type:"submit",value:"Upload File(s)/Folder"}),ss,ns])]),os,r("div",is,[P(" Available space: "+$(z(V).getHumanReadableFileSize(l.value))+" | ",1),r("i",{title:"Reset?",onClick:s[7]||(s[7]=t=>n.value=z(Te).defaultStoragePath),role:"button",class:"bi bi-arrow-counterclockwise default-reset-indicator"}),P(" Current path: "+$(z(n)),1)]),ls,I.value?(h(),_("div",hs,[r("div",{onDragenter:s[15]||(s[15]=t=>N(t,null)),onDragover:s[16]||(s[16]=t=>C(t)),onDragleave:s[17]||(s[17]=t=>X(t,null)),onDrop:s[18]||(s[18]=t=>L(t,null))},[r("div",{onClick:s[14]||(s[14]=t=>S(null)),role:"button",class:"tile-file"},[R(_e,{"icon-class-name":"bi-box-arrow-left","is-finished":!0}),_s])],32),(h(!0),_(W,null,oe(a.value,t=>(h(),_("div",{key:z(n)+t.name,title:`${t.name} (${z(V).getHumanReadableFileSize(t.size)})`,draggable:"true",onDragstart:u=>Z(u,t),onDragenter:u=>N(u,t),onDragover:u=>C(u),onDragleave:u=>X(u,t),onDrop:u=>L(u,t)},[r("div",{onClick:u=>S(t),role:"button",class:"tile-file"},[R(_e,{"icon-class-name":t.isDir?"bi-folder":"bi-file-earmark","is-finished":!0,onContextmenu:u=>Xe(u,t)},null,8,["icon-class-name","onContextmenu"]),P(" "+$(t.name),1)],8,bs)],40,Is))),128)),(h(!0),_(W,null,oe(z(re),t=>(h(),_("div",{key:z(n)+t.filename+"download",title:`${t.filename} (${z(V).getHumanReadableFileSize(t.fullSize)})`},[r("div",ys,[R(_e,{"icon-class-name":t.dirname.length>0?"bi-folder":"bi-file-earmark","progress-value":t.uploadedBytes/t.fullSize*100,onDownloadIsCancelled:w},null,8,["icon-class-name","progress-value"]),r("a",null,$(t.filename),1)])],8,Ds))),128))])):(h(),_("table",as,[rs,r("tr",null,[r("td",{role:"button",onClick:s[8]||(s[8]=t=>S(null)),onDrop:s[9]||(s[9]=t=>L(t,null)),onDragover:s[10]||(s[10]=t=>C(t))},fs,32)]),a.value.length==0?(h(),_("tr",{key:0,onDrop:s[11]||(s[11]=t=>L(t,null)),onDragover:s[12]||(s[12]=t=>C(t)),onDragenter:s[13]||(s[13]=t=>N(t,null))}," Nothing is here! ",32)):(h(!0),_(W,{key:1},oe(a.value,t=>(h(),_("tr",{key:z(n)+t.name,draggable:"true",onDragstart:u=>Z(u,t),onDrop:u=>L(u,t),onDragover:u=>C(u),onDragenter:u=>N(u,t),class:"row-file"},[r("td",null,[r("span",{role:"button",onClick:u=>S(t)},[t.isDir?(h(),_("i",ms)):$e("",!0),P(" "+$(t.name),1)],8,ps)]),r("td",null,$(z(V).getHumanReadableFileSize(t.size)),1),r("td",null,$(z(V).formatDate(t.lastModified)),1),r("td",null,[r("i",{onClick:u=>Q(t),role:"button",class:"bi bi-trash",title:"Delete"},null,8,vs),r("i",{onClick:u=>ye(t),style:{"margin-left":"5px"},role:"button",class:"bi bi-card-text",title:"Rename"},null,8,gs)])],40,cs))),128))])),ks,z(d).length>0?(h(),_("div",ws,[r("i",{role:"button",class:"bi bi-x-lg",onClick:s[19]||(s[19]=t=>z(d).length=0)}),zs,(h(!0),_(W,null,oe(z(d),t=>(h(),_("div",null,[r("progress",{max:"100",value:v(t)},$(v(t))+"%",9,Ms),P(" "+$(t.filename)+" ("+$(z(V).getHumanReadableFileSize(t.uploadedBytes))+" / "+$(z(V).getHumanReadableFileSize(t.fullSize))+") ",1)]))),256))])):$e("",!0)])],64)}}});var Ss=K(Fs,[["__scopeId","data-v-615a5f22"]]);const $s=j({setup(e){return(l,i)=>(h(),_("main",null,[R(Ss)]))}});nt($s).mount("#app");
